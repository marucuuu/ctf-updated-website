{% load static %}
        
<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Add Challenges</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="{% static 'admin_dashboard/assets/vendors/feather/feather.css' %}">
    <link rel="stylesheet" href="{% static 'admin_dashboard/assets/vendors/mdi/css/materialdesignicons.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin_dashboard/assets/vendors/ti-icons/css/themify-icons.css' %}">
    <link rel="stylesheet" href="{% static 'admin_dashboard/assets/vendors/font-awesome/css/font-awesome.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin_dashboard/assets/vendors/typicons/typicons.css' %}">
    <link rel="stylesheet" href="{% static 'admin_dashboard/assets/vendors/simple-line-icons/css/simple-line-icons.css' %}">
    <link rel="stylesheet" href="{% static 'admin_dashboard/assets/vendors/css/vendor.bundle.base.css' %}">
    <link rel="stylesheet" href="{% static 'admin_dashboard/assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.css' %}">
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <link rel="stylesheet" href="{% static 'admin_dashboard/assets/vendors/datatables.net-bs4/dataTables.bootstrap4.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'admin_dashboard/assets/js/select.dataTables.min.css' %}">
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="{% static 'admin_dashboard/assets/css/style.css' %}">
    <!-- endinject -->
    <link rel="shortcut icon" href="{% static 'admin_dashboard/assets/images/favicon.png' %}" />

    <style>
        .floating-alert {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050; /* Ensure it appears above other elements */
            width: 300px; /* Adjust width as needed */
        }
    </style>
    
  </head>
  <body class="with-welcome-text">
    <div class="container-scroller">
      
      <!-- partial:partials/_navbar.html -->
      {% include 'header/header.html'%}
      <!-- partial -->

      <div class="container-fluid page-body-wrapper">

        <!-- partial:partials/_sidebar.html -->
         
        {% include 'navbar/navbar.html' %}

        <!-- partial end -->

        <div class="main-panel">
            <div class="content-wrapper">
                <div class="container">
                    <div class="row justify-content-center">
                        <div class="col-lg-10">
                            <!-- Card Start -->
                            <div class="card shadow-sm mb-4">
                                <div class="card-header bg-light text-dark py-3">
                                    <h5 class="card-title mb-0">Add Challenge</h5>
                                </div>
                                <div class="card-body" style="background-color: #f8f9fa;">
                                    <p>Please fill out the form below to add a new challenge. Make sure to provide detailed information for each field. Required fields are marked with an asterisk (<span class="text-danger">*</span>).</p>
        
                                    <form id="challengeForm" method="POST" enctype="multipart/form-data">
                                        {% csrf_token %}

                                        <div class="mb-3">
                                            <label for="id_section" class="form-label">Section</label>
                                            {{ form.section }}
                                            <small class="form-text text-muted">Select the sections for this challenge. You can select multiple sections.</small>
                                            {% if form.section.errors %}
                                                <div class="invalid-feedback">{{ form.section.errors }}</div>
                                            {% endif %}
                                        </div>
                                    

                                        <!-- Challenge Name -->
                                        <div class="mb-3">
                                            <label for="id_name" class="form-label">Name of the Challenge <span class="text-danger">*</span></label>
                                            {{ form.name }}
                                            {% if form.name.errors %}
                                                <div class="invalid-feedback">{{ form.name.errors }}</div>
                                            {% endif %}
                                            <small class="form-text text-muted">Provide a unique and descriptive name for the challenge.</small>
                                        </div>
        
                                        <!-- Challenge Category -->
                                        <div class="mb-3">
                                            <label for="id_category" class="form-label">Category of the Challenge</label>
                                            {{ form.category }} <!-- This will render a dropdown -->
                                            <small class="form-text text-muted">Select the category that best fits the challenge. E.g., Web Security, Cryptography.</small>
                                            {% if form.category.errors %}
                                                <div class="invalid-feedback">{{ form.category.errors }}</div>
                                            {% endif %}
                                        </div>
        
                                        <!-- Challenge Content -->
                                        <div class="mb-3">
                                            <label for="id_content" class="form-label">Content <span class="text-danger">*</span></label>
                                            <textarea id="content-editor" name="content" class="form-control" rows="5"></textarea>
                                            <small class="form-text text-muted">Describe the challenge in detail. You can include any instructions or context needed.</small>
                                            {% if form.content.errors %}
                                                <div class="invalid-feedback">{{ form.content.errors }}</div>
                                            {% endif %}
                                        </div>
        
                                        <!-- Link Uploader -->
                                        <div class="mb-3">
                                            <label for="id_link" class="form-label">Link Uploader</label>
                                            {{ form.link }}
                                            <small class="form-text text-muted">Optional: Provide a link related to the challenge, such as a URL to a website or resource.</small>
                                            {% if form.link.errors %}
                                                <div class="invalid-feedback">{{ form.link.errors }}</div>
                                            {% endif %}
                                        </div>
        
                                        <!-- Hints -->
                                        <div class="mb-3">
                                            <label for="id_hints" class="form-label">Hints</label>
                                            <textarea id="id_hints" name="hints" class="form-control" rows="5" placeholder="Enter hints, each on a new line" oninput="processHints(this.value)"></textarea>
                                            <small class="form-text text-muted">Provide any hints that could help students solve the challenge. Separate each hint with a new line.</small>
                                            <div id="hintList" class="mt-2"></div>
                                            {% if form.hints.errors %}
                                                <div class="invalid-feedback">{{ form.hints.errors }}</div>
                                            {% endif %}
                                        </div>
        
                                        <!-- Points -->
                                        <div class="mb-3">
                                            <label for="id_points" class="form-label">Points</label>
                                            {{ form.points }}
                                            <small class="form-text text-muted">Specify the number of points the challenge is worth. Higher points are usually assigned to more difficult challenges.</small>
                                            {% if form.points.errors %}
                                                <div class="invalid-feedback">{{ form.points.errors }}</div>
                                            {% endif %}
                                        </div>
        
                                        <!-- Flag Answer -->
                                        <div class="mb-3">
                                            <label for="id_flag" class="form-label">Flag Answer <span class="text-danger">*</span></label>
                                            {{ form.flag }}
                                            <small class="form-text text-muted">Enter the correct flag that students will need to submit to solve the challenge. The flag is usually a string that matches a specific format.</small>
                                            {% if form.flag.errors %}
                                                <div class="invalid-feedback">{{ form.flag.errors }}</div>
                                            {% endif %}
                                        </div>
        
                                        <!-- Visible to Students -->
                                        <div class="mb-3 form-check ms-4">
                                            {{ form.visible }}
                                            <label class="form-check-label ms-1" for="id_visible">Visible to Students</label>
                                            <small class="form-text text-muted">Toggle this option to make the challenge visible to students. Uncheck to keep it hidden until ready.</small>
                                            {% if form.visible.errors %}
                                                <div class="invalid-feedback">{{ form.visible.errors }}</div>
                                            {% endif %}
                                        </div>
        
                                        <!-- Deadline -->
                                        <div class="mb-3">
                                            <label for="id_deadline" class="form-label">Deadline <span class="text-danger">*</span></label>
                                            {{ form.deadline }}
                                            <small class="form-text text-muted">Set a deadline for when the challenge must be completed by. Students will not be able to submit after this time.</small>
                                            {% if form.deadline.errors %}
                                                <div class="invalid-feedback">{{ form.deadline.errors }}</div>
                                            {% endif %}
                                        </div>
        
                                        <!-- File Uploader -->
                                        <div class="mb-3">
                                            <label for="id_file" class="form-label">File Uploader</label>
                                            {{ form.file }}
                                            <small class="form-text text-muted">Optionally, you can upload any related files that are necessary for the challenge, such as documents, images, or scripts.</small>
                                            {% if form.file.errors %}
                                                <div class="invalid-feedback">{{ form.file.errors }}</div>
                                            {% endif %}
                                        </div>
        
                                        <!-- Scoring Type -->
                                        <div class="mb-3">
                                            <label for="id_scoring_type" class="form-label">Scoring Type</label>
                                            {{ form.scoring_type }}
                                            <small class="form-text text-muted">Choose the scoring type for the challenge: Static or Dynamic. Static challenges have fixed points, while dynamic challenges may award variable points.</small>
                                            {% if form.scoring_type.errors %}
                                                <div class="invalid-feedback">{{ form.scoring_type.errors }}</div>
                                            {% endif %}
                                        </div>
        
                                        <!-- Submit Button -->
                                        <button type="submit" class="btn btn-primary w-100">Add Challenge</button>
                                    </form>
                                </div>
                            </div>
                            <!-- Card End -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        
            

    {% include 'notification/admin_notification.html' %}

    {% include 'tinymce/api.html'%}

    <script>
        function processHints(hintsText) {
            // Assuming the hints are separated by new lines
            let hints = hintsText.split("\n").filter(hint => hint.trim() !== "");
            let hintListDiv = document.getElementById("hintList");
    
            // Clear the previous hints list
            hintListDiv.innerHTML = "";
    
            // Dynamically create the list of hints
            hints.forEach(function(hint, index) {
                let hintItem = document.createElement("div");
                hintItem.innerHTML = `<strong>Hint ${index + 1}:</strong> ${hint}`;
                hintListDiv.appendChild(hintItem);
            });
        }
    </script>   

    <script>
        tinymce.init({
            selector: '#content-editor',  // Make sure this matches your textarea ID
            menubar: false,
            plugins: 'lists link image table',
            toolbar: 'undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image',
            height: 300,
        });
    </script>

    <!-- plugins:js -->
    <script src="{% static 'admin_dashboard/assets/vendors/js/vendor.bundle.base.js' %}"></script>
    <script src="{% static 'admin_dashboard/assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.js' %}"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <script src="{% static 'admin_dashboard/assets/vendors/chart.js/chart.umd.js' %}"></script>
    <script src="{% static 'admin_dashboard/assets/vendors/progressbar.js/progressbar.min.js' %}"></script>
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="{% static 'admin_dashboard/assets/js/off-canvas.js' %}"></script>
    <script src="{% static 'admin_dashboard/assets/js/template.js' %}"></script>
    <script src="{% static 'admin_dashboard/assets/js/settings.js' %}"></script>
    <script src="{% static 'admin_dashboard/assets/js/hoverable-collapse.js' %}"></script>
    <script src="{% static 'admin_dashboard/assets/js/todolist.js' %}"></script>
    <!-- endinject -->
    <!-- Custom js for this page-->
    <script src="{% static 'admin_dashboard/assets/js/jquery.cookie.js' %}" type="text/javascript"></script>
    <script src="{% static 'admin_dashboard/assets/js/dashboard.js' %}"></script>
    <!-- <script src="assets/js/Chart.roundedBarCharts.js"></script> -->
    <!-- End custom js for this page-->
  </body>
</html>